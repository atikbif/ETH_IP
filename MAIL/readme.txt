Здесь прошивка для платы сниффера
ip сделал как в логе было 192.168.2.101
CAN сейчас не используется. Только сам Ethernet/IP. Вместо реальных данных по переменным пустышки.
Если будет возможность запустите пожалуйста wireshark на время проверки чтобы логи посмотреть